<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sepetiniz</title>
    <style>
        .card { border: 1px solid #ddd; padding: 10px; margin: 10px; width: 700px; }
        .card-img-top { width: 200px; height: 200px; }
        .btn { padding: 10px; background-color: #f00; color: #fff; cursor: pointer; border: none; margin: 10px 0; }

        /* Özel alert stili */
        .custom-alert {
            display: none;
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            background-color: green;
            color: #fff;
            padding: 20px;
            border: 2px solid green;
            border-radius: 5px;
            width: 30%;
            height: 20px;
            text-align: center;
            font-size: 16px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            z-index: 9999;  /* Üstte görünmesi için yüksek z-index */
        }

        .btn{ 
            background-color: orange; color: #fff; 
        }

        .btn-sil {
            background-color: #fff; /* Normalde beyaz */
            color: #000; /* Yazı rengi siyah */
            border: 2px solid #ffa500; /* Turuncu sınır */
            cursor: pointer;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px; /* Köşeleri yuvarlatmak isterseniz */
        }

        .btn-sil:hover {
            background-color: #ffa500; /* Hover sırasında turuncu */
            color: #fff; /* Yazı rengi beyaz */
        }

        /* Yeni ödeme butonu stili */
        .btn-odeme {
            background-color: #ffa500; /* Yeşil renk */
            color: #fff;
            padding: 10px;
            margin: 10px 0;
            cursor: pointer;
            border: none;
            border-radius: 5px;
        }

        .btn-odeme:hover {
            background-color: #218838; /* Hover sırasında daha koyu yeşil */
        }

    </style>
</head>
<body>
    <h1>Sepetiniz</h1>
    <div id="cart-container"></div>
    <h3>Toplam Fiyat: <span id="total-price"></span> TL</h3>
    <button class="btn" onclick="clearCart()">Tümünü Sil</button>
    <button class="btn-odeme" onclick="window.location.href='/purchasePage'">Ödeme Yap</button>

    <!-- Özel alert kutusu -->
    <div id="alert" class="custom-alert">Sepetiniz boşaltıldı!</div>

    <script>
		document.addEventListener('DOMContentLoaded', (event) => {
		    const cartContainer = document.getElementById('cart-container');
		    const totalPriceElement = document.getElementById('total-price');

		    // Kullanıcının ID'sini al
		    const userId = localStorage.getItem("userId");

		    if (!userId) {
		        cartContainer.innerHTML = "<p>Lütfen giriş yapınız!</p>";
		        totalPriceElement.textContent = "0,00 TL";
		        return;
		    }

		    let cartKey = `cart_${userId}`;
		    let cart = JSON.parse(localStorage.getItem(cartKey)) || [];
		    let totalPrice = 0;

		    cart.forEach((item, index) => {
		        const productCard = document.createElement('div');
		        productCard.className = 'card';
		        productCard.innerHTML = `
		            <img src="${item.imageUrl}" class="card-img-top" alt="${item.description}">
		            <div class="card-description">${item.description}</div>
		            <p class="price">${item.price} TL</p>
		            <button class="btn-sil" onclick="removeFromCart(${index})">Sil</button>
		        `;
		        cartContainer.appendChild(productCard);

		        const price = parseFloat(item.price.replace(',', ''));
		        totalPrice += price + 0.001;
		    });

		    totalPrice = Math.round(totalPrice * 100);
		    let formattedTotalPrice = (totalPrice / 100).toLocaleString('tr-TR', { minimumFractionDigits: 3, maximumFractionDigits: 3 });
		    formattedTotalPrice = formattedTotalPrice.replace('.', ',');

		    totalPriceElement.textContent = `${formattedTotalPrice.replace(/,$/, '')}`;
		});

		function removeFromCart(index) {
		    const userId = localStorage.getItem("userId");
		    if (!userId) return;

		    let cartKey = `cart_${userId}`;
		    let cart = JSON.parse(localStorage.getItem(cartKey)) || [];
		    
		    cart.splice(index, 1);
		    localStorage.setItem(cartKey, JSON.stringify(cart));
		    location.reload();
		}

		function clearCart() {
		    const userId = localStorage.getItem("userId");
		    if (!userId) return;

		    let cartKey = `cart_${userId}`;
		    localStorage.removeItem(cartKey);

		    document.getElementById('cart-container').innerHTML = '';
		    document.getElementById('total-price').textContent = '0,00 TL';

		    const alertBox = document.getElementById('alert');
		    alertBox.style.display = 'block';

		    setTimeout(() => {
		        alertBox.style.display = 'none';
		    }, 3000);
		}

    </script>
</body>
</html>
















